/* ===========================
   TIPOGRAF√çAS
   =========================== */
@import url('https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;700&family=IM+Fell+English:ital@0;1&display=swap');

/* ===========================
   VARIABLES
   =========================== */
:root{
  --primary-color-light:#fdf6e3; --secondary-color-light:#3a2e28; --accent-color-light:#8b5e3c; --main-bg-light:#e8e0d5;
  --primary-color-sepia:#f4ecd8; --secondary-color-sepia:#5d4037; --accent-color-sepia:#d84315; --main-bg-sepia:#d7ccc8;
  --primary-color-bone:#f2f0e9; --secondary-color-bone:#4a453a; --accent-color-bone:#8c857b; --main-bg-bone:#dcdbd4;
  --primary-color-dark:#1e1e1e; --secondary-color-dark:#e0e0e0; --accent-color-dark:#ffab91; --main-bg-dark:#121212;

  --font-body:'Cormorant Garamond',serif;
  --font-title:'IM Fell English',serif;

  --bg-color:var(--primary-color-light);
  --text-color:var(--secondary-color-light);
  --accent-color:var(--accent-color-light);
  --main-bg:var(--main-bg-light);

  --font-size-dynamic:1.2rem;
}

/* Temas */
body.theme-light{--bg-color:var(--primary-color-light);--text-color:var(--secondary-color-light);--accent-color:var(--accent-color-light);--main-bg:var(--main-bg-light);}
body.theme-sepia{--bg-color:var(--primary-color-sepia);--text-color:var(--secondary-color-sepia);--accent-color:var(--accent-color-sepia);--main-bg:var(--main-bg-sepia);}
body.theme-bone{--bg-color:var(--primary-color-bone);--text-color:var(--secondary-color-bone);--accent-color:var(--accent-color-bone);--main-bg:var(--main-bg-bone);}
body.theme-dark {--bg-color:var(--primary-color-dark); --text-color:var(--secondary-color-dark); --accent-color:var(--accent-color-dark); --main-bg:var(--main-bg-dark);}

/* ===========================
   BASE
   =========================== */
html{background-color:var(--main-bg); width:100%; height:100%;}
body{
  margin:0; padding:0; width:100%; height:100%; min-height:100dvh;
  background-color:var(--main-bg);
  font-family:var(--font-body); color:var(--text-color);
  transition:background-color .5s ease, color .5s ease;
  overflow-x:hidden;
}

.hidden{display:none !important;}

#app-container{
  width:100%; max-width:1200px; margin:0 auto;
  display:flex; flex-direction:column;
  padding:20px; box-sizing:border-box;
  align-items:center; justify-content:center;
  min-height:100dvh;
}

/* HEADER */
#app-header{
  display:flex; justify-content:space-between; align-items:center;
  width:100%; max-width:1000px; padding-bottom:1rem; flex-shrink:0;
}

.left-group{display:flex; align-items:center; gap:.5rem;}

#main-title{
  font-family:var(--font-title); font-size:1.8rem;
  color:var(--accent-color); margin:0; letter-spacing:1px;
}

#home-btn{
  width:40px; height:35px; font-size:1.2rem;
  background:transparent; border:1px solid var(--accent-color);
  border-radius:5px; color:var(--accent-color); cursor:pointer;
}
#home-btn:hover{background:var(--accent-color); color:var(--bg-color);}

#settings-controls{display:flex; gap:.5rem; position:relative;}
button{
  background:transparent; border:1px solid var(--accent-color);
  color:var(--accent-color); border-radius:5px; cursor:pointer;
  display:flex; justify-content:center; align-items:center;
  transition:all .2s ease;
}
#settings-toggle,#fullscreen-btn,#nav-toggle{width:40px;height:35px;font-size:1.2rem;}
button:hover{background:var(--accent-color); color:var(--bg-color);}

#settings-menu{
  display:none; position:absolute; top:110%; right:0;
  background-color:var(--bg-color); border:1px solid var(--accent-color);
  border-radius:5px; padding:.5rem; z-index:100;
  box-shadow:0 5px 15px rgba(0,0,0,.2);
}
#settings-menu.visible{display:flex; gap:.5rem;}
#settings-menu button{width:40px; height:35px;}

/* ===========================
   BIBLIOTECA (HOME)
   =========================== */
#library-view{width:100%; max-width:1000px;}
.library-hero{
  width:100%; background:linear-gradient(180deg, rgba(0,0,0,.03), rgba(0,0,0,0));
  border:1px solid rgba(0,0,0,.05); border-radius:8px;
  padding:2rem 1.5rem; margin-bottom:1rem;
}
.library-hero-text h2{margin:.2rem 0 0; font-family:var(--font-title); color:var(--accent-color);}
.library-hero-text p{opacity:.8; margin:.3rem 0 0;}

.shelf-section{margin-top:1rem;}
.shelf-title{font-size:1.1rem; margin:.5rem 0 .75rem; opacity:.7;}
.book-shelf{
  display:grid; grid-auto-flow:column; grid-auto-columns: 70%;
  gap:14px; overflow-x:auto; padding-bottom:8px; scroll-snap-type:x mandatory;
}
@media(min-width:600px){ .book-shelf{grid-auto-columns: 33%;} }
@media(min-width:900px){ .book-shelf{grid-auto-columns: 25%;} }

.book-card{
  scroll-snap-align:center;
  background-color:var(--bg-color);
  border:1px solid rgba(0,0,0,.06);
  border-radius:10px; overflow:hidden;
  box-shadow:0 6px 16px rgba(0,0,0,.08);
  cursor:pointer; display:flex; flex-direction:column;
  transition:transform .2s ease, box-shadow .2s ease;
}
.book-card:hover{ transform:translateY(-2px); box-shadow:0 10px 20px rgba(0,0,0,.12); }

.book-cover{
  width:100%; aspect-ratio:3/4; object-fit:cover; display:block;
  filter:sepia(8%);
}
.book-info{ padding:.9rem 1rem; display:flex; flex-direction:column; gap:.25rem; }
.book-title{ font-family:var(--font-title); color:var(--text-color); font-size:1.15rem; line-height:1.2; }
.book-author{ font-size:.9rem; opacity:.7; }
.book-desc{ font-size:.95rem; opacity:.8; max-height:3.1em; overflow:hidden; }

/* ===========================
   LECTOR (tu app)
   =========================== */
#book-container{
  width:100%; max-width:900px;
  flex-grow:1; display:flex; flex-direction:column;
  position:relative; margin-bottom:20px; justify-content:center;
}
#book{ width:100%; height:100%; position:relative; display:flex; flex-direction:column; }

#page-wrapper{
  width:100%; height:100%;
  background-color:var(--bg-color);
  box-shadow:0 10px 30px -5px rgba(0,0,0,.2), 0 0 5px rgba(0,0,0,.05);
  border-radius:6px; border:1px solid rgba(0,0,0,.05);
  overflow:hidden; display:flex; flex-direction:column;
  position:relative; opacity:1; transform:translateX(0);
  transition:border-radius .3s ease, box-shadow .3s ease;
}
#page-wrapper::before{
  content:""; position:absolute; inset:0; opacity:.04; pointer-events:none; z-index:0;
  background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
}
#page-wrapper::after{
  content:""; position:absolute; inset:0; pointer-events:none; z-index:1;
  background:radial-gradient(circle, rgba(0,0,0,0) 60%, rgba(0,0,0,.05) 100%);
}

.page-exit{ animation:slideOutLeft .4s cubic-bezier(0.55, 0.085, 0.68, 0.53) forwards; }
@keyframes slideOutLeft{ 0%{opacity:1;transform:translateX(0) scale(1)} 100%{opacity:0; transform:translateX(-30px) scale(.95)} }
.page-enter{ animation:slideInRight .5s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards; }
@keyframes slideInRight{ 0%{opacity:0; transform:translateX(30px) scale(.95)} 100%{opacity:1; transform:translateX(0) scale(1)} }

.page-content{
  position:relative; z-index:2; padding:0; color:var(--text-color);
  overflow-y:auto; height:100%; scrollbar-width:thin; scrollbar-color:var(--accent-color) transparent;
  display:flex; flex-direction:column;
}
.content-centerer{
  padding:3rem 4rem; line-height:1.8;
  font-size:clamp(1.15rem, var(--font-size-dynamic, 1.2rem), 1.65rem);
  width:100%; box-sizing:border-box; margin:auto 0;
}
.page-content p{ margin-bottom:1.5rem; text-indent:2rem; text-align:justify; }
.page-content img{
  max-width:100%; max-height:65vh; width:auto; border-radius:2px;
  margin:2rem auto; display:block; box-shadow:0 4px 15px rgba(0,0,0,.1);
  filter:sepia(15%); object-fit:contain;
}
.choices{
  margin:3rem 0; display:flex; flex-direction:column; gap:1rem; align-items:center; padding-bottom:2rem;
}
.choices button{
  width:100%; max-width:500px; padding:15px 20px; font-family:var(--font-body); font-size:1.1rem; font-weight:700;
  background:transparent; border:1px solid var(--accent-color); color:var(--accent-color);
  box-shadow:0 2px 5px rgba(0,0,0,.05); transition:all .3s ease;
}
.choices button:hover{ background-color:var(--accent-color); color:var(--bg-color); transform:translateY(-2px); }
.page-number{
  position:relative; z-index:2; text-align:center; padding:1rem; font-style:italic; font-size:.9rem; opacity:.6;
  border-top:1px solid rgba(0,0,0,.05); margin-top:auto; flex-shrink:0;
}

#app-footer{ width:100%; max-width:900px; }
#progress-bar-container{ width:100%; height:4px; background-color:rgba(0,0,0,.1); margin-top:15px; border-radius:2px; }
#progress-bar{ height:100%; width:0%; background-color:var(--accent-color); transition:width .5s ease; border-radius:2px; }

/* MODAL */
.modal-overlay{
  position:fixed; inset:0; background-color:rgba(0,0,0,.5); backdrop-filter:blur(3px);
  z-index:1000; display:flex; justify-content:center; align-items:center;
  opacity:0; pointer-events:none; transition:opacity .3s ease;
}
.modal-overlay.active{ opacity:1; pointer-events:auto; }
.modal-content{
  width:90%; max-width:500px; max-height:80vh; background-color:var(--bg-color); color:var(--text-color);
  border-radius:8px; box-shadow:0 20px 50px rgba(0,0,0,.3); display:flex; flex-direction:column;
  transform:translateY(20px); transition:transform .3s ease; border:1px solid var(--accent-color);
}
.modal-overlay.active .modal-content{ transform:translateY(0); }
.modal-header{ padding:1.5rem; border-bottom:1px solid rgba(0,0,0,.1); display:flex; justify-content:space-between; align-items:center; }
.modal-header h2{ margin:0; font-family:var(--font-title); color:var(--accent-color); }
#nav-close{ font-size:1.2rem; border:none; }
.modal-body{ padding:1.5rem; overflow-y:auto; }
.danger-btn{ width:100%; padding:12px; background-color:rgba(200,50,50,.1); color:#c62828; border:1px solid #c62828; font-weight:bold; margin-bottom:1.5rem; }
.history-list-container h3{ margin-top:0; font-size:1rem; opacity:.7; text-transform:uppercase; letter-spacing:1px; }
#history-list{ list-style:none; padding:0; margin:0; position:relative; }
#history-list::before{ content:''; position:absolute; top:0; bottom:0; left:7px; width:2px; background-color:var(--accent-color); opacity:.3; }
.history-item{ position:relative; padding-left:25px; margin-bottom:15px; cursor:pointer; transition:opacity .2s; }
.history-item::before{ content:''; position:absolute; left:0; top:6px; width:16px; height:16px; border-radius:50%; background-color:var(--bg-color); border:2px solid var(--accent-color); z-index:1; }
.history-item.decision::before{ border-radius:2px; border-width:3px; background-color:var(--accent-color); }
.history-title{ font-weight:bold; display:block; font-size:1.1rem; }
.history-tag{ font-size:.7rem; background:var(--accent-color); color:var(--bg-color); padding:2px 6px; border-radius:4px; margin-left:5px; vertical-align:middle; }

/* MEDIA QUERIES */
@media (max-width:900px){
  #app-container{ padding:10px; }
  .content-centerer{ padding:2rem 2rem; }
}
@media (max-width:600px){
  #app-container{ padding:5px; }
  #book-container{ margin-bottom:10px; }
  .content-centerer{ padding:1.5rem 1.5rem; font-size:1.1rem; margin:0; }
  .page-content p{ text-indent:0; }
  .page-content img{ margin:1.5rem 0; max-height:70vh; width:100%; object-fit:contain; }
  #app-header{ padding-bottom:.5rem; }
  #main-title{ font-size:1.4rem; }
}

/* ===========================
   FULLSCREEN / ANDROID FIX
   =========================== */
:fullscreen::backdrop, :-webkit-full-screen::backdrop{ background-color:var(--bg-color); }
html.fullscreen-root{ background-color:var(--bg-color); }

body.fullscreen-mode{
  background-color:var(--bg-color);
  width:100vw; height:100vh; overflow:hidden;
}
body.fullscreen-mode #app-container{
  position:fixed; inset:0; width:100%; height:100%; padding:0; margin:0; max-width:none; z-index:9999; background-color:var(--bg-color);
  display:flex; flex-direction:column; justify-content:center; align-items:center;
}
body.fullscreen-mode #app-header,
body.fullscreen-mode #app-footer{ display:none !important; }

body.fullscreen-mode #book-container{
  width:100%; height:100%; margin:0; max-width:800px;
  padding-left:env(safe-area-inset-left); padding-right:env(safe-area-inset-right);
}
body.fullscreen-mode #page-wrapper{
  width:100%; height:100%; border-radius:0; border:none; box-shadow:none;
}
body.fullscreen-mode #page-wrapper::before,
body.fullscreen-mode #page-wrapper::after{ display:none; }
body.fullscreen-mode .content-centerer{ padding:2rem 1.5rem; max-width:100%; }

/* SVG */
svg{ fill:currentColor; width:20px; height:20px; }
